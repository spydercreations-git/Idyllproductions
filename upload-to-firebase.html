<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Videos to Firebase</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .upload-area { border: 2px dashed #ccc; padding: 40px; text-align: center; margin: 20px 0; }
        .upload-area:hover { border-color: #007bff; }
        .progress { width: 100%; height: 20px; background: #f0f0f0; margin: 10px 0; }
        .progress-bar { height: 100%; background: #007bff; width: 0%; transition: width 0.3s; }
        .result { margin: 10px 0; padding: 10px; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        select { padding: 8px; margin: 10px; border: 1px solid #ccc; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>üî• Upload Videos to Firebase Storage</h1>
    
    <div class="upload-area" onclick="document.getElementById('fileInput').click()">
        <p>Click here or drag and drop video files</p>
        <input type="file" id="fileInput" multiple accept="video/*" style="display: none;">
    </div>
    
    <div id="fileList"></div>
    <button id="uploadBtn" onclick="uploadFiles()" disabled>Upload All Videos</button>
    
    <div id="results"></div>
    <div id="urlOutput"></div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getStorage, ref, uploadBytes, getDownloadURL } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js';

        const firebaseConfig = {
            apiKey: "AIzaSyDzV_EQ1ibYyfS78oOItIgoO_T9AL2x0mc",
            authDomain: "idyll-productions-2025.firebaseapp.com",
            projectId: "idyll-productions-2025",
            storageBucket: "idyll-productions-2025.firebasestorage.app",
            messagingSenderId: "807032853840",
            appId: "1:807032853840:web:db6cbee90484fddf44c855"
        };

        const app = initializeApp(firebaseConfig);
        const storage = getStorage(app);

        let selectedFiles = [];
        const categories = {
            'short-form': 'videos/short-form',
            'saas-tech': 'videos/saas-tech', 
            'gaming': 'videos/gaming',
            'hero': 'videos/hero',
            'youtube-long-form': 'videos/youtube-long-form'
        };

        document.getElementById('fileInput').addEventListener('change', handleFileSelect);

        function handleFileSelect(event) {
            const files = Array.from(event.target.files);
            selectedFiles = files.map(file => ({
                file,
                category: guessCategory(file.name),
                customName: file.name
            }));
            
            displayFileList();
            document.getElementById('uploadBtn').disabled = selectedFiles.length === 0;
        }

        function guessCategory(filename) {
            const name = filename.toLowerCase();
            if (name.includes('ad') || name.includes('short')) return 'short-form';
            if (name.includes('saas') || name.includes('tech') || name.includes('doks') || name.includes('thoka') || name.includes('shapes') || name.includes('waves')) return 'saas-tech';
            if (name.includes('gaming') || name.includes('g.mp4')) return 'gaming';
            if (name.includes('hero') || name.includes('main') || name.includes('white')) return 'hero';
            return 'youtube-long-form';
        }

        function displayFileList() {
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = selectedFiles.map((item, index) => `
                <div style="border: 1px solid #ddd; padding: 10px; margin: 5px 0; border-radius: 4px;">
                    <strong>${item.file.name}</strong> (${(item.file.size / 1024 / 1024).toFixed(2)} MB)
                    <br>
                    <label>Category: 
                        <select onchange="updateCategory(${index}, this.value)">
                            ${Object.keys(categories).map(cat => 
                                `<option value="${cat}" ${cat === item.category ? 'selected' : ''}>${cat}</option>`
                            ).join('')}
                        </select>
                    </label>
                    <label>Custom name: 
                        <input type="text" value="${item.customName}" onchange="updateName(${index}, this.value)" style="margin-left: 10px; padding: 4px;">
                    </label>
                </div>
            `).join('');
        }

        window.updateCategory = function(index, category) {
            selectedFiles[index].category = category;
        }

        window.updateName = function(index, name) {
            selectedFiles[index].customName = name;
        }

        window.uploadFiles = async function() {
            const uploadBtn = document.getElementById('uploadBtn');
            const results = document.getElementById('results');
            const urlOutput = document.getElementById('urlOutput');
            
            uploadBtn.disabled = true;
            uploadBtn.textContent = 'Uploading...';
            results.innerHTML = '';
            
            const urls = {
                'short-form': [],
                'saas-tech': [],
                'gaming': [],
                'hero': [],
                'youtube-long-form': []
            };

            for (let i = 0; i < selectedFiles.length; i++) {
                const item = selectedFiles[i];
                const progress = document.createElement('div');
                progress.innerHTML = `
                    <div>Uploading ${item.customName}...</div>
                    <div class="progress"><div class="progress-bar" id="progress-${i}"></div></div>
                `;
                results.appendChild(progress);

                try {
                    const storageRef = ref(storage, `${categories[item.category]}/${item.customName}`);
                    const snapshot = await uploadBytes(storageRef, item.file);
                    const downloadURL = await getDownloadURL(snapshot.ref);
                    
                    urls[item.category].push(downloadURL);
                    
                    progress.innerHTML = `<div class="result success">‚úÖ ${item.customName} uploaded successfully!</div>`;
                    document.getElementById(`progress-${i}`).style.width = '100%';
                    
                } catch (error) {
                    progress.innerHTML = `<div class="result error">‚ùå Failed to upload ${item.customName}: ${error.message}</div>`;
                }
            }

            // Generate the constants file content
            const constantsContent = `// Auto-generated Firebase video URLs
export const FIREBASE_VIDEO_URLS = ${JSON.stringify(urls, null, 2)};

export const HERO_VIDEO_URL = "${urls.hero[0] || 'https://placeholder-url.com/hero.mp4'}";

export const getVideosForCategory = (category: keyof typeof FIREBASE_VIDEO_URLS) => {
  return FIREBASE_VIDEO_URLS[category] || [];
};`;

            urlOutput.innerHTML = `
                <h3>üéâ Upload Complete!</h3>
                <p>Copy this code to <code>constants/firebaseVideoUrls.ts</code>:</p>
                <textarea style="width: 100%; height: 300px; font-family: monospace;">${constantsContent}</textarea>
                <button onclick="copyToClipboard()">Copy to Clipboard</button>
            `;

            uploadBtn.disabled = false;
            uploadBtn.textContent = 'Upload All Videos';
        }

        window.copyToClipboard = function() {
            const textarea = document.querySelector('textarea');
            textarea.select();
            document.execCommand('copy');
            alert('Copied to clipboard!');
        }
    </script>
</body>
</html>